import { describe, it, expect } from 'vitest'

import { reportBody } from './reportBody'

describe('reportBody', () => {
  it('should return body comment', () => {
    const owner = 'octocat'
    const repo = 'hello-world'
    const issueNumber = 1
    const sha = '8ef39983ce21a9c80821addbeb63bfe4d4068f9a'
    const mermaidText = 'flowchart LR\n\nA ---> B'
    const cmdText =
      '/usr/local/bin/npx -p @mh4gf/dependency-cruiser depcruise --output-type plugin:@mh4gf/dependency-cruiser/mermaid-reporter-plugin --config /home/runner/work/dependency-cruiser-report-action/dependency-cruiser-report-action/.dependency-cruiser.js dist/index.js dist/index.js.map src/options.ts'
    const expected = `<!-- This comment was generated by dependency-cruiser-report-action. id: ab9d1a5ad3256cbba8c22a27e3c4ef3dabb0f0289ea1f3505ac4537afb1e92bf -->
# dependency-cruiser report

visualize dependenices of changed files.

\`\`\`mermaid
flowchart LR

A ---> B
\`\`\`

Report generated by <a href="https://github.com/MH4GF/dependency-cruiser-report-action">dependency-cruiser report action</a> 8ef39983ce21a9c80821addbeb63bfe4d4068f9a

---

<details>
<summary>execute command</summary>

\`\`\`
/usr/local/bin/npx -p @mh4gf/dependency-cruiser depcruise --output-type plugin:@mh4gf/dependency-cruiser/mermaid-reporter-plugin --config /home/runner/work/dependency-cruiser-report-action/dependency-cruiser-report-action/.dependency-cruiser.js dist/index.js dist/index.js.map src/options.ts
\`\`\`

</details>
`
    expect(reportBody({ owner, repo, issueNumber, sha, mermaidText, cmdText })).toBe(expected)
  })
})
